---
layout: post
title: 'Understanding Our Auto-Generated Code: Views'
date: '2013-05-28T13:37:00.000+03:00'
author: Fred Muya
tags:
- Yii Framework
modified_time: '2013-05-28T14:00:09.420+03:00'
thumbnail: http://1.bp.blogspot.com/-fqKAdV-8QdA/UaLuLulf0DI/AAAAAAAAA4Y/O16IYu4DC74/s72-c/breadcrumbs_with_arrow.png
blogger_id: tag:blogger.com,1999:blog-3630098189866392828.post-7957774897559617303
blogger_orig_url: http://encore254.blogspot.com/2013/05/understanding-our-auto-generated-code_28.html
---

<span style="font-family: Trebuchet MS, sans-serif;">In this post, we discuss the views auto-generated by Gii.</span><br /><span style="font-family: Trebuchet MS, sans-serif;"><br /></span><span style="font-family: Trebuchet MS, sans-serif;">By default, the views are generated in a folder under the views folder under protected, i.e. protected/views. The name of the folder generated is the same as the table name. For example, if the name of the table is users, like in our case, then the folder will be called 'users'.</span><br /><span style="font-family: Trebuchet MS, sans-serif;"><br /></span><br /><div class="gistLoad" data-id="5655242" id="gist-GistID">Getting some awesome code... </div><br />The admin view is rendered from the render method. The render method accepts 3 parameters:<br /><br /><ol><li><span style="font-family: Courier New, Courier, monospace;">string $view</span> - The name of the view to be rendered.</li><li><span style="font-family: Courier New, Courier, monospace;">array $data</span> - An array having the parameters to be sent to the view. (Optional)</li><li><span style="font-family: Courier New, Courier, monospace;">boolean $return</span> - whether the rendering result should be returned instead of being displayed. (Optional)</li></ol><div>In the code snippet above, we're rendering the admin view. And the data being sent is <span style="font-family: Courier New, Courier, monospace;">$model</span>. The key used in the array is what will be used in the view. So in the case above, we'll refer to the variable using the variable <span style="font-family: Courier New, Courier, monospace;">$model</span>. If we used <span style="font-family: Courier New, Courier, monospace;">'userModel'</span> as the key in the array, we'd use <span style="font-family: Courier New, Courier, monospace;">$userModel</span> in the view.<br /><br />Partial Views are rendered using the renderPartial method. They are usually used within main views.<br /><br />admin View<br />The admin view displays your data in a CGridView. It has the following items:<br /><br /><ul><li>Breadcrumbs - This refers to the links that appear on the top of the users admin page&nbsp;<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-fqKAdV-8QdA/UaLuLulf0DI/AAAAAAAAA4Y/O16IYu4DC74/s1600/breadcrumbs_with_arrow.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="90" src="http://1.bp.blogspot.com/-fqKAdV-8QdA/UaLuLulf0DI/AAAAAAAAA4Y/O16IYu4DC74/s320/breadcrumbs_with_arrow.png" width="320" /></a></div></li><li>Menu - This refers to the links that appear on the side of the page. Menu contents are defined in an array having the following keys:</li><ul><li><span style="font-family: Courier New, Courier, monospace;">string 'label'</span> - &nbsp;defines the text that will be displayed to the user, e.g. 'Manage Users'</li><li><span style="font-family: Courier New, Courier, monospace;">array 'url'</span> - defines the URL for the link (i.e. the HTML <span style="font-family: Courier New, Courier, monospace;">href</span> property). It's usually defined in the format <span style="font-family: Courier New, Courier, monospace;">'contoller/action'</span>, e.g. <span style="font-family: Courier New, Courier, monospace;">'users/admin'</span> OR<span style="font-family: Courier New, Courier, monospace;"> 'users/create'</span>. A custom URL can also be defined</li><li><span style="font-family: Courier New, Courier, monospace;">array 'linkOptions'</span> - defines any additional properties that should be added to the HTML Link Tag (<span style="font-family: Courier New, Courier, monospace;"><a href="http://www.blogger.com/blogger.g?blogID=3630098189866392828"></a></span>). For example, if we want the link to be opened in a new tab, we can add the key=&gt;value pair: <span style="font-family: Courier New, Courier, monospace;">'target' =&gt; '_BLANK'</span>, so that the property<span style="font-family: Courier New, Courier, monospace;"> 'target' </span>will be defined for the link. You can read more about Yii CMenu <a href="http://www.yiiframework.com/doc/api/1.1/CMenu" rel="nofollow" target="_blank">here</a>.</li></ul><li>Some JavaScript - Yii registers some JavaScript here that will be used to control the 'Advanced Search' button. The function <span style="font-family: Courier New, Courier, monospace;">Yii::app()-&gt;clientScript-&gt;registerScript()</span> is used to define JavaScript on the fly. In this case, some jQuery is used to bind a mouse click on the Advanced Search button to display and hide the Search form. It also binds the form's submit function to update the CGridView below using AJAX.</li><li>A button to toggle the search form, and a partial render for the search form</li><li>The CGridView widget.</li></ul><div>We'll discuss the partial render and the CGridView in more detail.</div><div><br /></div><div>A CGridView is a Yii widget used to display data in a tabular form. Widgets in Yii are fetched using the <span style="font-family: Courier New, Courier, monospace;">widget()</span> method.</div><div class="gistLoad" data-id="5655356" id="gist-GistID">Getting some awesome code...</div><div><br />The first parameter to the method is the <a href="http://www.yiiframework.com/doc/guide/1.1/en/basics.namespace" rel="nofollow" target="_blank">alias</a>&nbsp;of the widget; second is an array having parameters used by the widget. CGridView uses the following parameters as keys:<span style="font-family: Courier New, Courier, monospace;"> 'id'</span>, <span style="font-family: Courier New, Courier, monospace;">'dataProvider'</span>, <span style="font-family: Courier New, Courier, monospace;">'filter'</span>,<span style="font-family: Courier New, Courier, monospace;"> 'columns'</span>. More parameters are explained <a href="http://www.yiiframework.com/doc/api/1.1/CGridView" rel="nofollow" target="_blank">here</a>.<br /><br />Columns to be displayed are defined in the <span style="font-family: Courier New, Courier, monospace;">'columns'</span> parameter. The data columns can be defined as:<br /><br /><ul><li>a string representing the column name in the database, e.g. 'userID'</li><li>an array representing <a href="http://www.yiiframework.com/doc/api/1.1/CDataColumn" rel="nofollow" target="_blank">CDataColumn</a>&nbsp;properties, i.e. 'name', 'value', 'type', etc</li></ul><div>Normally, we don't want to display 'raw' IDs to the users in our grid view, especially for cases where a value in a column is a foreign key of another table. For example, in our system, all tables have the column <span style="font-family: Courier New, Courier, monospace;"><b>status</b></span>. The value of the <span style="font-family: Courier New, Courier, monospace;"><b>status</b></span> column references a value in the <span style="font-family: Courier New, Courier, monospace;"><b>entityStates</b></span> table. So instead of displaying 1 in that field, we can display the corresponding <b><span style="font-family: Courier New, Courier, monospace;">entityStateName</span></b>, i.e. <b>ACTIVE</b></div></div><div><br />To do this, we need to ensure that the relation to <span style="font-family: Courier New, Courier, monospace;">EntityStates</span> is defined in the Users model. First, use Gii to generate a model for the <b><span style="font-family: Courier New, Courier, monospace;">entityStates</span></b> table. Then modify the <span style="font-family: Courier New, Courier, monospace;">relations</span> function in the Users model to include a relation to <span style="font-family: Courier New, Courier, monospace;">EntityStates</span>. The updated code should be as below:<br /><br /><br /></div><div class="gistLoad" data-id="5655411" id="gist-GistID">Getting some awesome code... </div><br />I normally append an underscore for <span style="font-family: Courier New, Courier, monospace;">'BELONGS_TO' </span>relations to differentiate them from the <span style="font-family: Courier New, Courier, monospace;">'HAS_MANY'</span> relations, in this case, <span style="font-family: Courier New, Courier, monospace;">'status_'</span>.<br /><br />Then update the users admin view file; add the string: <span style="font-family: Courier New, Courier, monospace;">'status_.entityStateName'</span>. If you refresh the users admin page view, you should see the entity state name in the status field.<br /><br />Finally, we can change what is displayed as the header of the column having entity state Name to Status. In the Users model, update the <span style="font-family: Courier New, Courier, monospace;">attributeLabels()</span> to include the label <span style="font-family: Courier New, Courier, monospace;">'status_.entityStateName'</span>. It's value should be <span style="font-family: Courier New, Courier, monospace;">'Status'</span>. The header for that column is now '<b>Status</b>'.<br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-R3GsYD19l3s/UaL7BaMJPGI/AAAAAAAAA5U/FOV99Cv1_ro/s1600/adminView_withArrow.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="71" src="http://2.bp.blogspot.com/-R3GsYD19l3s/UaL7BaMJPGI/AAAAAAAAA5U/FOV99Cv1_ro/s320/adminView_withArrow.png" width="320" /></a></div><br />The last item of the columns array is <span style="font-family: Courier New, Courier, monospace;">'CButtonColumn'</span>. This defines the buttons that appear on the last column of the table. Additional properties can be defined to format how items are displayed on that column. You can read up on additional CButtonColumn properties <a href="http://www.yiiframework.com/doc/api/1.1/CButtonColumn" rel="nofollow" target="_blank">here</a><br /><br />Also defined in the admin view is a partial render of the search form. _search.php is one of the partial views that was auto-generated in the users view folder. The renderPartial method takes the same parameters as the render method. In this case, the name of the partial view is '_search', and the array contains the parameter that will be passed, i.e. 'model'. If you go ahead and take a peek at the code in _search.php file, you'll notice that it is basically a form that displays some search fields. We'll discuss the form fields when going through the _form partial view.<br /><br />That's it for this post. In the next one, we'll discuss the other views.<br /><br />Your questions, comments and suggestions are always welcome below.<br /><br />NB: I've uploaded the code for this project on GitHub. Check it out (or clone :) <a href="https://github.com/muya/student-portal" target="_blank">here</a>.<br /><script src="https://raw.github.com/moski/gist-Blogger/master/public/gistLoader.js" type="text/javascript"></script></div>